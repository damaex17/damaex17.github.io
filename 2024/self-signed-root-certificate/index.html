<!DOCTYPE html> <html lang = "en"> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="yandex-verification" content="e801bebf4149cd4c" /> <title> Self-Signed Certificates | inversegravity.net </title> <meta name="description" content=" How to create your own CA and why this is useful "> <meta name="keywords" content="openssl self-signed CA certificate authority CSR signing request mTLS internal network"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Linkedin --> <meta property="og:type" content="article"> <meta property="article:author" content="Maximilian Weber"> <meta property="article:section" content=""> <meta property="article:tag" content="openssl self-signed CA certificate authority CSR signing request mTLS internal network"> <meta property="article:published_time" content="2024-11-10 00:00:00 +0000"> <meta property="og:url" content="https://inversegravity.net/2024/self-signed-root-certificate/"> <meta property="og:title" content=" Self-Signed Certificates | inversegravity.net "> <meta property="og:description" content=" How to create your own CA and why this is useful "> <meta property="og:site_name" content="Maximilian Weber"> <meta property="og:locale" content="en_US"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="inversegravityN"> <meta name="twitter:title" content=" Self-Signed Certificates | inversegravity.net "> <meta name="twitter:description" content=" How to create your own CA and why this is useful "> <meta property="og:image" content="https://inversegravity.net/assets/images/Knee-Pain.jpg" /> <meta name="twitter:image" content="https://inversegravity.net/assets/images/Knee-Pain.jpg" /> <!-- Canonical link tag --> <script type="text/javascript" src="https://inversegravity.net/loadworker.js"></script> <link rel="canonical" href="https://inversegravity.net/2024/self-signed-root-certificate/"> <link rel="alternate" type="application/rss+xml" title="inversegravity.net" href="https://inversegravity.net/feed.xml"> <!-- rel prev and next --> <meta name="theme-color" content="#f5f5f5"/> <link rel="stylesheet" href="https://inversegravity.net/assets/css/main.css"/> <link rel="manifest" href="https://inversegravity.net/manifest.webmanifest"/> <link rel="apple-touch-icon" href="https://inversegravity.net/favicon.ico"/> <script type="text/javascript"> window._mNHandle = window._mNHandle || {}; window._mNHandle.queue = window._mNHandle.queue || []; medianet_versionId = "3121199"; </script> <script src="https://contextual.media.net/dmedianet.js?cid=8CUGXGUP4" async="async"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-1QJBHD3CVQ"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-1QJBHD3CVQ'); </script> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="https://inversegravity.net/">inversegravity<span>.net</span></a></h1> <ul class="navbar"> <li><a href="https://inversegravity.net/privacy/">privacy</a></li> <li><a href="https://inversegravity.net/about/">about</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <p class="post-meta"><time datetime="2024-11-10T00:00:00+00:00" itemprop="datePublished">Nov 10, 2024</time></p> <h1 class="post-title" itemprop="name headline">Self-Signed Certificates</h1> </header> <div class="post-content" itemprop="articleBody"> <h5 id="encryption-remains-a-cornerstone-for-safeguarding-sensitive-information-while-commercial-certificate-authorities-cas-provide-trusted-ssl-certificates-for-public-facing-services-a-self-signed-certificate-can-be-a-practical-and-cost-effective-solution-for-internal-network-communications">Encryption remains a cornerstone for safeguarding sensitive information. While commercial Certificate Authorities (CAs) provide trusted SSL certificates for public-facing services, a self-signed Certificate can be a practical and cost-effective solution for internal network communications.</h5> <p>Although modern browsers typically reject self-signed certificates due to trust issues, these certificates are valuable for encrypting internal traffic.</p> <p>By creating your own self-signed certificate and using it to sign Certificate Signing Requests (CSRs), you can secure data transmission across your internal networks or implement mutual TLS (mTLS) for client and server authentication.</p> <p>In this post, we explore the process of setting up a self-signed certificate and demonstrate how to sign CSRs, highlighting the benefits of this strategy for internal security resilience.</p> <p><br /></p> <p align="center"> <img src="/assets/images/key.jpg" alt="picture of a key" /> <br /> </p> <h3 id="create-private-key">Create Private Key</h3> <p>The private key serves as the foundational element for creating a self-signed certificate because it is at the core of the cryptographic operations that underpin certificate signing and validation.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ openssl genrsa -aes256 -out CA.key 4096
</code></pre></div></div> <p>Note that we use OpenSSL to generate a secure 4096-bit <a href="/2019/public-key/" target="_blank">asymmetric</a> RSA private key and secure it with the <a href="/2019/crypto-symmetric/" target="_blank">symmetric</a> AES algorithm. Other options for algorithms and key length can be found in the manpage of OpenSSL.</p> <p>OpenSSL will ask for a passphrase. Protecting the private key is essential, as any compromise could allow malicious actors to issue fraudulent certificates, undermining trust and security within your internal environment.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Enter PEM pass phrase:
Verifying - Enter PEM pass phrase:
</code></pre></div></div> <h3 id="create-the-self-signed-root-certificate">Create the Self-Signed Root Certificate</h3> <p>We can now proceed to create our self-signed root certificate using the private key.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ openssl req -x509 -new -nodes -key CA.key -sha256 -days 1826 -out CA.crt
</code></pre></div></div> <p>In this step, we use the sha256 <a href="/2019/crypto-hash-digital-signature/" target="_blank">hashing algorithms</a> and set the certificate’s validity to 1826 days or roughly 5 years. As always, alternative options are available in the man page of OpenSSL.</p> <p>You will be asked to enter the passphrase for the private key you selected, as well as to answer several questions.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Enter pass phrase for CA.key:
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:DE
State or Province Name (full name) [Some-State]:Bavaria
Locality Name (eg, city) []:Munich
Organization Name (eg, company) [Internet Widgits Pty Ltd]:inversegravity    
Organizational Unit Name (eg, section) []:InfoSec
Common Name (e.g. server FQDN or YOUR name) []:inversegravity
Email Address []:inversegravity.net@gmail.com
</code></pre></div></div> <p>While the responses to these questions are not particularly critical, they do appear when viewing the certificate, a task you will seldom need to do. For the Common Name, I recommend choosing something easily identifiable as your root certificate among other certificates.</p> <p>With the self-signed Root Certificate, our internal “CA” is now operational.</p> <h3 id="create-a-certificate-signing-request-csr">Create a Certificate Signing Request (CSR)</h3> <p>Let’s generate our Certificate Signing Request (CSR) for our first certificate, which could be used to secure internal network traffic. This process mirrors what customers typically submit to a trusted Certificate Authority (CA) for signing.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ openssl req -newkey rsa:2048 -keyout CSR.key -out CSR.csr
</code></pre></div></div> <p>Unlike with our root certificate, where the key was generated separately, we create the private key alongside the CSR and use the RSA algorithm with a shorter key length of 2048 bits.</p> <p>We also employ the -nodes option to leave the private key unencrypted, avoiding the need to enter a password when restarting the service utilizing the certificate.</p> <p>Lastly, we omit the x509 argument to signal to OpenSSL that we are creating a CSR instead of a self-signed certificate.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>..+................+............+..+.......+++++++++++++++++++++++++++++++++......
+++..........+++++++++++++++++++++++++++++++++++++++........+++++++++++++++++++...
++++++++++++++++++++++++++++++++++++++++++++++++++++++++......+++++++++..........+


-----
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:DE
State or Province Name (full name) [Some-State]:Bavaria
Locality Name (eg, city) []:Munich
Organization Name (eg, company) [Internet Widgits Pty Ltd]:inversegravity
Organizational Unit Name (eg, section) []:InfoSec
Common Name (e.g. server FQDN or YOUR name) []:nas.internal.inversegravity.net
Email Address []:inversegravity.net@gmail.com

Please enter the following 'extra' attributes
to be sent with your certificate request
A challenge password []:
An optional company name []:

</code></pre></div></div> <p>The dots (.) and plus signs (+) you see provide a visual indication that the process of generating randomness required for key creation is underway, ensuring that the key is as secure as possible.</p> <p>The password from the ‘extra’ attributes is not used to encrypt the CSR. It’s only used by some trusted CAs for certificate revocation. The optional company name can be omitted as well for our use-case.</p> <h3 id="sign-the-csr">Sign the CSR</h3> <p>Now it’s time to sign the CSR with our self-signed root certificate. We essentially act as your own CA in this case.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ openssl x509 -req -days 365 -in CSRcsr -CA CA.crt -CAkey CA.key -out CSR.crt 
-set_serial 01 -sha256
</code></pre></div></div> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Certificate request self-signature ok
subject=C = DE, ST = Bavaria, L = Munich, O = inversegravity, OU = security, 
CN = nas.internal.inversegravity.net, emailAddress = inversegravity@gmail.com
Enter pass phrase for CA.key:
</code></pre></div></div> <p>You have to enter the password of the private key of the self-signed root certificate to sign the CSR.</p> <h3 id="certificate-usage">Certificate Usage</h3> <p>Having generated a certificate, we can leverage it in various software development scenarios and internal network applications. However, it’s important to remember that web browsers do not inherently trust this certificate, as they typically require validation from a trusted Certificate Authority (CA) to establish authenticity.</p> <p>Here are a few practical use cases where your certificate can be applied:</p> <ul> <li> <p>VPN Authentication: Certificates can be used to authenticate clients and servers within virtual private networks (VPNs). This ensures that only authorized users and devices can access the network, enhancing security and privacy.</p> </li> <li> <p>Mutual Transport Layer Security (mTLS): In mTLS, both the client and server authenticate each other using certificates. This bidirectional authentication process adds an extra layer of security, ensuring that both parties are verified before communication is established.</p> </li> <li> <p>Transport Layer Security (TLS): TLS is used to encrypt data transmitted over networks, securing communication between clients and servers. By using your certificate, you can facilitate encrypted connections within internal applications or systems, protecting sensitive data from interception and tampering.</p> </li> </ul> <h3 id="certificate-confusion">Certificate Confusion</h3> <p>In this post we started by creating a self-signed root certificate, which, while not inherently trusted on the open internet, can serve as a trusted entity within our internal environments.</p> <p>By using this root certificate, we’ve signed a Certificate Signing Request (CSR) to generate a “service” certificate. This certificate can be effectively used to secure an internal web server or protect our internal network, improving our security posture.</p> <p>Although these service certificates are not automatically trusted by standard web browsers, they can be manually added for our internal services, ensuring smooth operations and heightened security within our controlled environments.</p> <p>Utilizing self-signed certificates provides flexibility and control, allowing you to manage secure communications without the need for third-party Certificate Authorities (CAs).</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                                +------------------+
                                | Root Certificate |
                                |    Self-Signed   |
                                +------------------+
                                          |
                                +---------+--------+
                                |                  |
                         +-------------+    +-------------+
                         | Certificate |    | Certificate |
                         +-------------+    +-------------+
</code></pre></div></div> <h3 id="why-try-self-signed-certificates">Why Try Self-Signed Certificates?</h3> <ul> <li> <p>Cost-Effective Security: You can enhance security without incurring the cost of purchasing certificates from external CAs, making it an economical choice for development and internal applications.</p> </li> <li> <p>Learning Experience: Implementing self-signed certificates is a valuable exercise in understanding cryptographic concepts, certificate management, and network security principles.</p> </li> <li> <p>Tailored Security: You can design security measures specifically tailored to your organization’s internal needs, ensuring that critical data and communications are protected.</p> </li> </ul> <p>I encourage everyone to explore and utilize self-signed certificates within your development and internal network environments. By doing so, you’ll gain practical insights into security management and discover how to effectively safeguard your systems and data.</p> </div> <div id="291704505"> <script type="text/javascript"> try { window._mNHandle.queue.push(function (){ window._mNDetails.loadTag("291704505", "320x50", "291704505"); }); } catch (error) {} </script> </div> <span><div style="text-align:center">[ <a href="/tag/security/"><code class="highlighter-rouge"><nobr>security</nobr></code></a> <a href="/tag/technology/"><code class="highlighter-rouge"><nobr>technology</nobr></code></a> <a href="/tag/cryptography/"><code class="highlighter-rouge"><nobr>cryptography</nobr></code></a> ]</div></span> <aside class="share"> <div style="text-align:center"><p>If you liked this article, please share it on <a href="http://twitter.com/share?text=Self-Signed Certificates. How to create your own CA and why this is useful&amp;url=https://inversegravity.net/2024/self-signed-root-certificate/&amp;via=inversegravityN" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">Twitter</a> or <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://inversegravity.net/2024/self-signed-root-certificate/" onclick="window.open(this.href, 'linkedin-share', 'width=550,height=235');return false;">LinkedIn</a></p></div> </aside> </article> <footer class="site-footer"> <div class="container"> <div style="text-align:center"> <small class="block">&copy; 2024 Maximilian Weber &middot; &lt;/&gt; Powered by <a href="https://jekyllrb.com/">Jekyll</a> </small> </div> </footer> </main> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=G-1QJBHD3CVQ"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-1QJBHD3CVQ'); </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> <style> #cookie-notice {padding: 7px 15px; display: none; text-align: center; position: fixed; bottom: 0; width: 100%; background: #fff; color: rgba(0,0,0,0.8);} #cookie-notice a {cursor: pointer; margin-left: 10px;} @media (max-width: 767px) { #cookie-notice span {display: block; padding-top: 3px; margin-bottom: 13px;} #cookie-notice a {position: relative; bottom: 4px;} } </style> <div id="cookie-notice"><span> By using and navigating this website you agree that we use GitHub Pages, Google Analytics, and Cloudflare.</span><a id="cookie-notice-accept" class="btn btn-primary btn-sm"><br>OK</a></div> <script> function createCookie(name,value,days) { var expires = ""; if (days) { var date = new Date(); date.setTime(date.getTime() + (days*24*60*60*1000)); expires = "; expires=" + date.toUTCString(); } document.cookie = name + "=" + value + expires + "; path=/"; } function readCookie(name) { var nameEQ = name + "="; var ca = document.cookie.split(';'); for(var i=0;i < ca.length;i++) { var c = ca[i]; while (c.charAt(0)==' ') c = c.substring(1,c.length); if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length); } return null; } function eraseCookie(name) { createCookie(name,"",-1); } if(readCookie('cookie-notice-dismissed')=='true') { } else { $('#cookie-notice').show(); } $('#cookie-notice-accept').click(function() { createCookie('cookie-notice-dismissed','true',31); $('#cookie-notice').hide(); location.reload(); }); </script> </body> </html>
