<!DOCTYPE html> <html lang = "en"> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="yandex-verification" content="e801bebf4149cd4c" /> <title> Cryptography - Symmetric Key Algorithms | inversegravity.net </title> <meta name="description" content=" Symmertric Cryptography "> <meta name="keywords" content="cryptography symmetric AES DES 3DES"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Facebook / Open Graph --> <meta property="og:type" content="article"> <meta property="article:author" content="Maximilian Weber"> <meta property="article:section" content=""> <meta property="article:tag" content="cryptography symmetric AES DES 3DES"> <meta property="article:published_time" content="2019-05-14 00:00:00 +0000"> <meta property="og:url" content="https://inversegravity.net/2019/crypto-symmetric/"> <meta property="og:title" content=" Cryptography - Symmetric Key Algorithms | inversegravity.net "> <meta property="og:description" content=" Symmertric Cryptography "> <meta property="og:site_name" content="Maximilian Weber"> <meta property="og:locale" content="en_US"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="inversegravityN"> <meta name="twitter:title" content=" Cryptography - Symmetric Key Algorithms | inversegravity.net "> <meta name="twitter:description" content=" Symmertric Cryptography "> <meta property="og:image" content="https://inversegravity.net/assets/images/symmetry.jpg" /> <meta name="twitter:image" content="https://inversegravity.net/assets/images/symmetry.jpg" /> <!-- Canonical link tag --> <script type="text/javascript" src="https://inversegravity.net/loadworker.js"></script> <link rel="canonical" href="https://inversegravity.net/2019/crypto-symmetric/"> <link rel="alternate" type="application/rss+xml" title="inversegravity.net" href="https://inversegravity.net/feed.xml"> <!-- rel prev and next --> <meta name="theme-color" content="#f5f5f5"/> <link rel="stylesheet" href="https://inversegravity.net/assets/css/main.css"/> <link rel="manifest" href="https://inversegravity.net/manifest.webmanifest"/> <link rel="apple-touch-icon" href="https://inversegravity.net/favicon.ico"/> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="https://inversegravity.net/">inversegravity<span>.net</span></a></h1> <ul class="navbar"> <li><a href="https://inversegravity.net/privacy/">privacy</a></li> <li><a href="https://inversegravity.net/about/">about</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <p class="post-meta"><time datetime="2019-05-14T00:00:00+00:00" itemprop="datePublished">May 14, 2019</time></p> <h1 class="post-title" itemprop="name headline">Cryptography - Symmetric Key Algorithms</h1> </header> <div class="post-content" itemprop="articleBody"> <p><a href="/2019/crypto-history-basics/">Cryptography - History and Basics</a></p> <p><a href="/2019/crypto-symmetric/">Cryptography - Symmetric Key Algorithms</a></p> <p><a href="/2019/public-key/">Cryptography - Asymmetric Key Algorithms</a></p> <p><a href="/2019/crypto-hash-digital-signature/">Cryptography - Hash Functions &amp; Digital Signatures</a></p> <p><a href="/2019/applied-cryptography/">Cryptography - Applications</a></p> <h3 id="symmetric-key-algorithms---definition">Symmetric Key Algorithms - Definition</h3> <p>Symmetric Key Algorithms are based on a shared secret key which is distributed to all members participating in the encrypted communication. The key is used to encrypted and decrypt the message. The sender and receiver are both in the possession of a copy of the shared key.</p> <p>When large keys are used, the symmetric encryption is very difficult to break. The primary use case for it is bulk encryption (eg. hard drives) with a high speed.</p> <p>Alternative terms: <em>private key cryptography</em> or <em>shared private key</em></p> <p><img src="/assets/images/symmetry.jpg" alt="a picture representing symmetry" style="left; padding: 10px 10px 10px 10px;" /></p> <h3 id="advantage-of-symmetric-key-cryptography">Advantage of Symmetric Key Cryptography</h3> <p><strong>Secure</strong> Symmetric Key Cryptography is extremely secure if it is used with a secure algorithm, and a large key.</p> <p><strong>Fast</strong> Encrypting and Decrypting symmetric key data is considerably faster than in asymmetric key algorithms</p> <h3 id="disadvantages-of-symmetric-key-cryptography">Disadvantages of Symmetric Key Cryptography</h3> <p><strong>Key distribution</strong> is a major problem since parties must have a secure method of exchanging the secret key before communication can be established. The method of offline key distribution is called out-of-band exchange.</p> <p><strong>Nonrepudiation</strong> is not given since each party uses the same key to encrypt and decrypt. There is no way to prove the origin of a message.</p> <p><strong>Not scalable</strong> secure communication in a group can only be achieved if each possible combination of users exchanges a shared private key.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Number of Keys = (n(n-1)/2
</code></pre></div></div> <p><strong>Key regeneration</strong> all keys must be regenerated if one user leaves the group.</p> <h3 id="des---data-encryption-standard">DES - Data Encryption Standard</h3> <p>The Data Encryption Standard or DES is a symmetric-key algorithm that was developed in the early 1970s. Its short key length of 56-bit (+8 bit parity) was criticized from the beginning. Nowadays this algorithm is no longer recommended for use since intelligence agencies are believed to routinely decrypt DES-encrypted information. This algorithm is nevertheless important to understand because it is highly influential for the more advanced modern cryptography algorithms.</p> <p>DES is the archetypal block cipher - an algorithm that takes a fixed-length string of plaintext bits (DES: 64-bit) and transforms it into a ciphertext string of the same length. In the case of DES, the transformation is accomplished by an exclusive OR (XOR) operation. This process is repeated 16 times for each encryption/decryption operation.</p> <p>It supports 5 different modes:</p> <p><strong>Electronic Code Book Mode - ECB</strong> is the simplest mode and the least secure. Each time the algorithm processes a 64-bit block, it simply encrypts the block using the secret key. Encrypting the same block twice produces the same result. This makes the mode vulnerable to building a “code book”. After a sufficient number of encrypted blocks are gathered, cryptoanalytic techniques could decipher some of the blocks and break the encryption. ECB was only used for the exchange of small amounts of data such as keys or parameters or for encrypting the fields in a database.</p> <p><strong>Cipher Block Chaining Mode - CBC</strong> describes the mode in which each unencrypted block of text is XORed with the block of ciphertext preceding it before it is encrypted. The decryption process simply reverses this behavior. CBC introduces an <em>initialization vector (IV)</em> and XORs it with the first block of the to be encrypted message. This IV is sent to all recipients either in plaintext or by using ECB. The main problem of CBC is that errors in the message propagate. One corrupted block makes it impossible to decrypt the message.</p> <p><strong>Cipher Feedback Mode - CFB</strong> is simply the streaming version of CBC. It operates against data in real-time. Instead of working with 64-bit blocks of text is uses a memory buffer of the same block size. It encrypts the buffer once it is full and sends it to the recipients. CFB operates in the same fashion as CBC, it uses an IV and is chaining the blocks (buffers).</p> <p><strong>Output Feedback Mode - OFB</strong> operates on streaming data with buffers in the same way as CFB. However, instead of XORing the encrypted version of the previous block (buffer), it uses a seed value as the IV. Future seed values are derived by running the DES algorithm on the previous seed value. The biggest advantage of this mode is that there is no chaining function and therefore errors do not propagate. This makes the mode more robust.</p> <p><strong>Counter Mode - CTR</strong> is similar to OFC but instead of creating the seed value for each encryption/decryption from the results of the previous seed values, it uses a simple counter and increments it for each operation. As with OFB mode, errors do not propagate in CTR mode. CTR also allows to break the operation (encryption/decryption) in multiple steps and is therefore well suited for parallel computing.</p> <h3 id="3des---triple-des">3DES - Triple DES</h3> <p>The 56-bit key of DES is no longer considered adequate in the times of modern cryptoanalytic and the availability of almost endless computational power (cloud). An adapted version of called Triple DES or 3DES uses the same algorithm to produce more secure encryption.</p> <p>There are four versions of 3DES:</p> <p><strong>DES-EEE3</strong> encrypts the plaintext 3 times using 3 different keys (K1, K2, and K3) and runs 3 encryption operations. It has an effective key length of 168-bit. (P = plaintext, E = encryption)</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>E(K1,E(K2,E(K3,P)))
</code></pre></div></div> <p><strong>DES-EDE3</strong> uses also 3 keys but replaces the second encryption operation with a decryption operation. The key length is 168-bit.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>E(K1,D(K2,E(K3,P)))
</code></pre></div></div> <p><strong>DES-EEE2</strong> uses only 2 keys as follows and has an effective key length of 112-bit.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>E(K1,E(K2,E(K1,P)))
</code></pre></div></div> <p><strong>DES-EDE2</strong> uses 2 keys and replaces the second encryption operation with a decryption operation. The key length is 112-bit.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>E(K1,D(K2,E(K1,P)))
</code></pre></div></div> <h3 id="idea---international-data-encryption-algorithm">IDEA - International Data Encryption Algorithm</h3> <p>IDEA was developed in response to the criticism of the insufficient key length of DES. Like DES it operates on 64-bit blocks or buffers of plaintext/ciphertext. It begins the operation with a 128-bit key which is broken up in 56x 16-bit subkeys. The subkeys are then used in a combination of XOR and modulus to produce the encrypted/decrypted version of the input message. IDEA is operating with the same five modes of DES: ECB, CBC, CFB, OFC, and CTR. One well-known implementation of IDEA is Phil Zimmerman’s <a href="https://en.wikipedia.org/wiki/Pretty_Good_Privacy"><em>Pretty Good Privacy (PGP)</em></a>.</p> <h3 id="blowfish">Blowfish</h3> <p>Another alternative to DES and IDEA is Bruce Schneier’s <a href="https://en.wikipedia.org/wiki/Blowfish_(cipher)">Blowfish</a> block cipher. It also operates with 64-bit blocks of text but allows to define the key length ranging from a relative insecure 32-bit to an extremely strong 448-bit. With longer keys, the encryption/decryption time obviously increases. Blowfish was released for public use and is built in a number of commercial and open source products (eg. SSH, or Linux).</p> <h3 id="skipjack">Skipjack</h3> <p>This algorithm uses 64-bit blocks of text and an 80-bit key. It supports all modes of operation of DES and was adopted by the U.S. government. It has an added <em>feature</em> of supporting the escrow of encryption keys. Two government agencies (National Institute of Standards and Technology - NIST and Department of Treasury - DOT), hold a portion of the information required to reconstruct a Skipjack key. Law enforcements can obtain the pieces of keys, and decrypt Skipjack communication. This algorithm was obviously not embraced by the cryptographic community but is in wide use with the U.S. government.</p> <h3 id="rc2rc5---rivest-cipher-rsa">RC2/RC5 - Rivest Cipher (RSA)</h3> <p>This is a symmetric key algorithm patented by Rivest-Shamir-Adleman (RSA) Data Security and is found in commercial products.</p> <ul> <li>RC2 uses a block size of 64-bit and a key size of 128-bit.</li> <li>RC5 uses a block size of 32, 64, or 128-bit and a variable key size ranging from 0 - 2040-bit</li> </ul> <h3 id="aesrijndael---advanced-encryption-standard">AES/Rijndael - Advanced Encryption Standard</h3> <p><a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard">AES</a> allows three key strengths: 128 bits, 192 bits, and 256 bits and encrypts 128-bit blocks of text. The underlying block-cipher Rijndael exceeds the AES specification and allows to use a block size equal to the key length. The number of encryption rounds in AES depends on the key length:</p> <ul> <li>128-bit key -&gt; 10 rounds of encryption</li> <li>192-bit key -&gt; 12 rounds of encryption</li> <li>256-bit key -&gt; 14 rounds of encryption</li> </ul> <h3 id="twofish">Twofish</h3> <p>The Twofish was also developed by Bruce Schneier and was a finalist in the AES contest. Twofish is a block cipher and operates on 128-bit blocks of data. It is capable of using key sizes ranging from 1 - 256-bit in length. Twofish introduces two new techniques which are not found in other algorithms:</p> <p><strong>Prewhitening</strong> is the process of XORing the plaintext with a separate subkey before the first round of encryption.</p> <p><strong>Postwhitening</strong> uses a similar operation after the 16th round of encryption.</p> <hr /> <h3 id="distribution-of-symmetric-keys">Distribution of Symmetric Keys</h3> <p>One of the major challenges of symmetric encryption algorithms is the secure distribution the secret keys. There are three general methods used to exchange keys securely.</p> <p><strong>Offline Distribution</strong> This is the technically most simple method and requires the physical exchange of the key material in the <a href="https://en.wikipedia.org/wiki/Real_life#Related_terminology">meatspace</a>. One party provides the other with a medium (e.g. sheet of paper, or flash drive) which contains the secret key.</p> <p><strong>Public Key Encryption</strong> Here we overcome the hassle of secret key distribution by using public key encryption for the initial setup of the communication (exchange of secret key). Once the secret key has been exchanged, the communication switches to a secret key algorithm to benefit from increased processing speed.</p> <p><strong>Diffie-Hellman</strong> There are use-cases where offline distribution is not feasible (no physical means) and public key encryption is not available (lack of <a href="/2019/public-key-infrastructure/">public key infrastructure</a>). In a situation like this so-called key exchange algorithms like Diffie-Hellmann are useful mechanisms to exchange the secret key to enable symmetric key communication.</p> <p><strong>1.</strong> Bob and Alice have to agree on two large numbers. <code class="highlighter-rouge">P</code> (prime number) and <code class="highlighter-rouge">G</code> (integer) such that:</p> <p><code class="highlighter-rouge">1 &lt; G &lt; P</code></p> <p><strong>2.</strong> Bob now chooses a random large integer <code class="highlighter-rouge">R</code> and performs the following calculation:</p> <p><code class="highlighter-rouge">B = G^R mod P</code></p> <p><strong>3.</strong> Alice chooses a random large integer <code class="highlighter-rouge">S</code> and performs the following calculation:</p> <p><code class="highlighter-rouge">A = G^S mod P</code></p> <p><strong>4.</strong> Bob sends <code class="highlighter-rouge">B</code> to Alice and she sends <code class="highlighter-rouge">A</code> to Bob.</p> <p><strong>5.</strong> Bob performs the following calculation:</p> <p><code class="highlighter-rouge">K = A^R mod P</code></p> <p><strong>6.</strong> Alice performs the following calculation:</p> <p><code class="highlighter-rouge">K = B^S mod P</code></p> <p>At this point both Bob and Alice have the same value <code class="highlighter-rouge">K</code>, and can use this for communication with a symmetric key algorithm.</p> </div> <span><div style="text-align:center">[ <a href="/tag/security/"><code class="highlighter-rouge"><nobr>security</nobr></code></a> <a href="/tag/technology/"><code class="highlighter-rouge"><nobr>technology</nobr></code></a> ]</div></span> <aside class="share"> <div style="text-align:center"><p>If you liked this article, please share it on <a href="http://twitter.com/share?text=Cryptography - Symmetric Key Algorithms. Symmertric Cryptography&amp;url=https://inversegravity.net/2019/crypto-symmetric/&amp;via=inversegravityN" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">Twitter</a></p></div> </aside> </article> <footer class="site-footer"> <div class="container"> <small class="block">&copy; 2020 Maximilian Weber &middot; &lt;/&gt; Powered by <a href="https://jekyllrb.com/">Jekyll</a> </small> </div> </footer> </main> <script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-138082100-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> <!--script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script--> <style> #cookie-notice {padding: 7px 15px; display: none; text-align: center; position: fixed; bottom: 0; width: 100%; background: #fff; color: rgba(0,0,0,0.8);} #cookie-notice a {cursor: pointer; margin-left: 10px;} @media (max-width: 767px) { #cookie-notice span {display: block; padding-top: 3px; margin-bottom: 13px;} #cookie-notice a {position: relative; bottom: 4px;} } </style> <div id="cookie-notice"><span> By using and navigating this website you agree that we use GitHub Pages, Google Analytics, and Cloudflare.</span><a id="cookie-notice-accept" class="btn btn-primary btn-sm"><br>OK</a></div> <script> function createCookie(name,value,days) { var expires = ""; if (days) { var date = new Date(); date.setTime(date.getTime() + (days*24*60*60*1000)); expires = "; expires=" + date.toUTCString(); } document.cookie = name + "=" + value + expires + "; path=/"; } function readCookie(name) { var nameEQ = name + "="; var ca = document.cookie.split(';'); for(var i=0;i < ca.length;i++) { var c = ca[i]; while (c.charAt(0)==' ') c = c.substring(1,c.length); if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length); } return null; } function eraseCookie(name) { createCookie(name,"",-1); } if(readCookie('cookie-notice-dismissed')=='true') { } else { $('#cookie-notice').show(); } $('#cookie-notice-accept').click(function() { createCookie('cookie-notice-dismissed','true',31); $('#cookie-notice').hide(); location.reload(); }); </script> </body> </html>
