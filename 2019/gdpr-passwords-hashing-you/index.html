<!DOCTYPE html> <html lang = "en"> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="yandex-verification" content="e801bebf4149cd4c" /> <title> GDPR, Passwords, Hashing and You | inversegravity.net </title> <meta name="description" content=" New obligations regarding password systems "> <meta name="keywords" content="GDPR password account security hashing salt argon2 BCrypt SCrypt rate limits"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Linkedin --> <meta property="og:type" content="article"> <meta property="article:author" content="Maximilian Weber"> <meta property="article:section" content=""> <meta property="article:tag" content="GDPR password account security hashing salt argon2 BCrypt SCrypt rate limits"> <meta property="article:published_time" content="2019-04-24 00:00:00 +0000"> <meta property="og:url" content="https://inversegravity.net/2019/gdpr-passwords-hashing-you/"> <meta property="og:title" content=" GDPR, Passwords, Hashing and You | inversegravity.net "> <meta property="og:description" content=" New obligations regarding password systems "> <meta property="og:site_name" content="Maximilian Weber"> <meta property="og:locale" content="en_US"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="inversegravityN"> <meta name="twitter:title" content=" GDPR, Passwords, Hashing and You | inversegravity.net "> <meta name="twitter:description" content=" New obligations regarding password systems "> <meta property="og:image" content="https://inversegravity.net/assets/images/gdpr_1.jpg" /> <meta name="twitter:image" content="https://inversegravity.net/assets/images/gdpr_1.jpg" /> <!-- Canonical link tag --> <script type="text/javascript" src="https://inversegravity.net/loadworker.js"></script> <link rel="canonical" href="https://inversegravity.net/2019/gdpr-passwords-hashing-you/"> <link rel="alternate" type="application/rss+xml" title="inversegravity.net" href="https://inversegravity.net/feed.xml"> <!-- rel prev and next --> <meta name="theme-color" content="#f5f5f5"/> <link rel="stylesheet" href="https://inversegravity.net/assets/css/main.css"/> <link rel="manifest" href="https://inversegravity.net/manifest.webmanifest"/> <link rel="apple-touch-icon" href="https://inversegravity.net/favicon.ico"/> <script type="text/javascript"> window._mNHandle = window._mNHandle || {}; window._mNHandle.queue = window._mNHandle.queue || []; medianet_versionId = "3121199"; </script> <script src="https://contextual.media.net/dmedianet.js?cid=8CUGXGUP4" async="async"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-1QJBHD3CVQ"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-1QJBHD3CVQ'); </script> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="https://inversegravity.net/">inversegravity<span>.net</span></a></h1> <ul class="navbar"> <li><a href="https://inversegravity.net/privacy/">privacy</a></li> <li><a href="https://inversegravity.net/about/">about</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <p class="post-meta"><time datetime="2019-04-24T00:00:00+00:00" itemprop="datePublished">Apr 24, 2019</time></p> <h1 class="post-title" itemprop="name headline">GDPR, Passwords, Hashing and You</h1> </header> <div class="post-content" itemprop="articleBody"> <h5 id="passwords-low-entropy-secrets-play-a-critical-role-in-keeping-information-safe-for-this-reason-ensuring-password-security-is-a-critical-element-in-information-security">Passwords (low-entropy secrets) play a critical role in keeping information safe. For this reason, ensuring password security is a critical element in information security.</h5> <h3 id="disclaimer">Disclaimer</h3> <p>This article is my interpretation of the law and personal opinion. GDPR does not contain any specifics about passwords. The <a href="https://ico.org.uk/for-organisations/guide-to-data-protection/guide-to-the-general-data-protection-regulation-gdpr/security/passwords-in-online-services/" target="_blank">UK Information Commissioner’s Office - ICO</a> published a useful guide for the development of password protection systems after GDPR.</p> <h3 id="password-systems-and-the-gdpr">Password systems and the GDPR</h3> <p>GDPR not only introduces the principles of <strong>privacy by design</strong> and <strong>privacy by default</strong>, but in <a href="https://www.imperva.com/learn/data-security/gdpr-article-32/" target="_blank">Article 32</a> it also defines the obligation for data security and data loss prevention.</p> <blockquote> <p>Access to personal data is protected by passwords. In order to protect personal data, passwords have to be protected</p> </blockquote> <p>Any password system developed or deployed has to be protected against <strong>brute force</strong>, <strong>dictionary</strong>, <strong>guessing</strong> and <a href="/2019/vulnerability-disclosure-at-signup/"><strong>credential stuffing</strong></a> attacks. The password itself is treated as personal data and requires state of the art protection.</p> <p>Shortly after the introduction of GDPR a German company reported a data breach in accordance with Article 33 GDRP to the authorities. During the investigation, it was discovered that the passwords have been stored in clear text. This was interpreted as a violation of Article 32 GDRP and the company was fined <a href="https://www.theregister.co.uk/2018/11/23/knuddels_fined_for_plain_text_passwords/" target="_blank">EUR 20.000</a>.</p> <blockquote> <p>“By storing the passwords in clear text, the company knowingly violated its duty to ensure data security in the processing of personal data.” the authority said.</p> </blockquote> <p>The company wasn’t fined for the breach but because of the password storage strategy!</p> <h3 id="state-of-the-art-methods-for-password-storage">State of the art methods for password storage</h3> <p>Under GDPR a strong password storage strategy is critical in mitigating data breaches. Hashing passwords is no longer just an option and the hashing method should be <em>state of the art</em>.</p> <p>Requirements for the hashing method:</p> <ul> <li>The honest player needs to be able to compute a single instance of the algorithm on standard hardware for moderate costs.</li> <li>The adversary should not be able to reduce costs by calculating multiple instances of the algorithm on customized hardware.</li> <li>The time for calculating the hash should not depend on the length of the password.</li> <li>Identical input has to produce a different output (nondeterministic).</li> </ul> <p><strong>One way function</strong></p> <p>This is better than clear text but attackers have found ways around this implementation. If a couple of users were to use the same password, their hash would be identical. Multiple accounts mapped to the same hash indicate a commonly used password. With this knowledge, hackers can considerably narrow down the number of passwords used in an attack. Attackers can also utilize databases of pre-computed hashes (<a href="https://en.wikipedia.org/wiki/Rainbow_table" target="_blank">rainbow table attacks</a>).</p> <p><strong>The salt</strong></p> <p>Salting the input increases the complexity of the output without increasing user requirements. A salt is a fixed-length cryptographically strong value added to the input. But fixed salt strings can get exposed in a data breach and the attacker can neglect the advantage of using a salt. This implementation also produces deterministic outcomes.</p> <p><strong>BCrypt, PBKDF2 or SCrypt - key stretching</strong></p> <p>This is a great improvement over the mentioned above methods but I do not recommend the commonly implemented BCrypt, PBKDF2 or SCrypt methods for newly designed systems anymore.</p> <p><em>BCrypt and PBKDF2</em> are key stretching or key derivation functions and do not offer memory hardness. This means those methods are CPU bound and prone to password cracking by Application Specific Integrated Circuits (ASICs). Whitepapers have emerged regarding <a href="https://www.usenix.org/system/files/conference/woot14/woot14-malvoni.pdf" target="_blank">Energy-Efficient Bcrypt Cracking with Low-CostParallel Hardware</a>.</p> <p><em>SCrypt</em> adds memory-hard functions (MHFs). It is CPU and Memory intensive to calculate. But I see an issue with the usage in <a href="https://coinpaprika.com/tag/scrypt?all=true" target="_blank">cryptocurrencies</a>. Mining solutions for SCrypt are <a href="https://cryptomining-blog.com/10810-new-innosilicon-a6-ltc-master-2-2-ghs-scrypt-asic-miner/" target="_blank">available</a> and these could be repurposed for <em>offline cracking</em>. SCrypt also doesn’t give many options to configure parameters to balance parameters. In my opinion, this is an important feature to tailor the method to your use case.</p> <h3 id="argon2---appropriate-hashing">Argon2 - appropriate hashing</h3> <p>My recommendation for a newly designed password storage system is argon2.</p> <ul> <li>open source implementations in all commonly used languages</li> <li>has been around for a while</li> <li>withstood studies to accelerate the algorithm on dedicated hardware</li> <li>parameters to control execution time, memory requirements and degree of parallelism</li> <li>won the <a href="https://password-hashing.net/" target="_blank">Password Hashing Competition</a></li> </ul> <p><img src="/assets/images/gdpr_1.jpg" alt="GDPR symbolic picture" style="float: center; padding: 10px 10px 10px 10px;" /></p> <h3 id="preventing-a-data-breach">Preventing a data breach</h3> <p>Hashing will protect passwords after a data breach. Other privacy information is usually stored in clear text. The risk for a data breach can be reduced by implementing processes, controls, and audits.</p> <p>Consider the following:</p> <ul> <li>User rights management - Access control</li> <li>Privileged user monitoring</li> <li>Immutable audit trail for machines and humans</li> <li>Secure archiving for forensics</li> <li>Data access auditing</li> <li>Data discovery and classification</li> <li>Change management</li> <li>Rate limiting</li> <li>Employee background checks</li> <li>Encryption of private information</li> </ul> <h3 id="evaluation-process-with-gdpr">Evaluation process with GDPR</h3> <p>GDPR changes the requirements for engineers and we need to put more thought into designing a system. Evaluation processes and decision making has to be documented along the following criteria:</p> <p><strong>State of the Art</strong></p> <p>Use the most advanced approach and measure it against the ever-evolving cybersecurity threat landscape. Keep on learning, educate yourself, assess risks and anticipate attacks. Be aware of threats relevant for your use case. A successful security strategy is never “done”.</p> <p><strong>Risk Profile</strong></p> <p>Know your companies unique risk profile and customize your solutions accordingly. Risk profiles include core requirements for systems. This profile has to be re-evaluated according to company changes or changes to the threat level.</p> <p><strong>Processing Profile</strong></p> <p>Evaluate the nature, scope, context, and purposes of the processing of personal data. It is essential to understand what data is where and for which purpose. Data might be the oil of the 21st century but minimizing the amount of collected data is required. Collect only data you need for business and legal reasons.</p> <p><strong>Cost</strong></p> <p>Evaluate the costs of an implementation according to the risk profile.</p> <h3 id="conclusion">Conclusion</h3> <p>In this post, I wanted to show how to satisfy GDRP requirements for password storage and what to take into consideration. It’s fine to run a legacy system with BCrypt but when designing a new system we need to use technology with a high probability to stand the test of time. Or at least the next decade. It’s on us engineers to stay informed about the continuous evolution of cybersecurity threats and adapt our approach.</p> </div> <div id="291704505"> <script type="text/javascript"> try { window._mNHandle.queue.push(function (){ window._mNDetails.loadTag("291704505", "320x50", "291704505"); }); } catch (error) {} </script> </div> <span><div style="text-align:center">[ <a href="/tag/security/"><code class="highlighter-rouge"><nobr>security</nobr></code></a> <a href="/tag/technology/"><code class="highlighter-rouge"><nobr>technology</nobr></code></a> <a href="/tag/privacy/"><code class="highlighter-rouge"><nobr>privacy</nobr></code></a> ]</div></span> <aside class="share"> <div style="text-align:center"><p>If you liked this article, please share it on <a href="http://twitter.com/share?text=GDPR, Passwords, Hashing and You. New obligations regarding password systems&amp;url=https://inversegravity.net/2019/gdpr-passwords-hashing-you/&amp;via=inversegravityN" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">Twitter</a> or <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://inversegravity.net/2019/gdpr-passwords-hashing-you/" onclick="window.open(this.href, 'linkedin-share', 'width=550,height=235');return false;">LinkedIn</a></p></div> </aside> </article> <footer class="site-footer"> <div class="container"> <div style="text-align:center"> <small class="block">&copy; 2022 Maximilian Weber &middot; &lt;/&gt; Powered by <a href="https://jekyllrb.com/">Jekyll</a> </small> </div> </footer> </main> <!-- <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=G-1QJBHD3CVQ"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-1QJBHD3CVQ'); </script> --> <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> <style> #cookie-notice {padding: 7px 15px; display: none; text-align: center; position: fixed; bottom: 0; width: 100%; background: #fff; color: rgba(0,0,0,0.8);} #cookie-notice a {cursor: pointer; margin-left: 10px;} @media (max-width: 767px) { #cookie-notice span {display: block; padding-top: 3px; margin-bottom: 13px;} #cookie-notice a {position: relative; bottom: 4px;} } </style> <div id="cookie-notice"><span> By using and navigating this website you agree that we use GitHub Pages, Google Analytics, and Cloudflare.</span><a id="cookie-notice-accept" class="btn btn-primary btn-sm"><br>OK</a></div> <script> function createCookie(name,value,days) { var expires = ""; if (days) { var date = new Date(); date.setTime(date.getTime() + (days*24*60*60*1000)); expires = "; expires=" + date.toUTCString(); } document.cookie = name + "=" + value + expires + "; path=/"; } function readCookie(name) { var nameEQ = name + "="; var ca = document.cookie.split(';'); for(var i=0;i < ca.length;i++) { var c = ca[i]; while (c.charAt(0)==' ') c = c.substring(1,c.length); if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length); } return null; } function eraseCookie(name) { createCookie(name,"",-1); } if(readCookie('cookie-notice-dismissed')=='true') { } else { $('#cookie-notice').show(); } $('#cookie-notice-accept').click(function() { createCookie('cookie-notice-dismissed','true',31); $('#cookie-notice').hide(); location.reload(); }); </script> </body> </html>
