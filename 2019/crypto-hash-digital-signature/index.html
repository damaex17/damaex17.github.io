<!DOCTYPE html> <html lang = "en"> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="yandex-verification" content="e801bebf4149cd4c" /> <title> Cryptography - Hash Functions &amp; Digital Signatures | inversegravity.net </title> <meta name="description" content=" Hash Functions &amp; Digital Signatures "> <meta name="keywords" content="cryptography hash functions digital signature"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Linkedin --> <meta property="og:type" content="article"> <meta property="article:author" content="Maximilian Weber"> <meta property="article:section" content=""> <meta property="article:tag" content="cryptography hash functions digital signature"> <meta property="article:published_time" content="2019-05-21 00:00:00 +0000"> <meta property="og:url" content="https://inversegravity.net/2019/crypto-hash-digital-signature/"> <meta property="og:title" content=" Cryptography - Hash Functions &amp; Digital Signatures | inversegravity.net "> <meta property="og:description" content=" Hash Functions &amp; Digital Signatures "> <meta property="og:site_name" content="Maximilian Weber"> <meta property="og:locale" content="en_US"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="inversegravityN"> <meta name="twitter:title" content=" Cryptography - Hash Functions &amp; Digital Signatures | inversegravity.net "> <meta name="twitter:description" content=" Hash Functions &amp; Digital Signatures "> <meta property="og:image" content="https://inversegravity.net/assets/images/one-way.jpg" /> <meta name="twitter:image" content="https://inversegravity.net/assets/images/one-way.jpg" /> <!-- Canonical link tag --> <script type="text/javascript" src="https://inversegravity.net/loadworker.js"></script> <link rel="canonical" href="https://inversegravity.net/2019/crypto-hash-digital-signature/"> <link rel="alternate" type="application/rss+xml" title="inversegravity.net" href="https://inversegravity.net/feed.xml"> <!-- rel prev and next --> <meta name="theme-color" content="#f5f5f5"/> <link rel="stylesheet" href="https://inversegravity.net/assets/css/main.css"/> <link rel="manifest" href="https://inversegravity.net/manifest.webmanifest"/> <link rel="apple-touch-icon" href="https://inversegravity.net/favicon.ico"/> <script type="text/javascript"> window._mNHandle = window._mNHandle || {}; window._mNHandle.queue = window._mNHandle.queue || []; medianet_versionId = "3121199"; </script> <script src="https://contextual.media.net/dmedianet.js?cid=8CUGXGUP4" async="async"></script> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="https://inversegravity.net/">inversegravity<span>.net</span></a></h1> <ul class="navbar"> <li><a href="https://inversegravity.net/privacy/">privacy</a></li> <li><a href="https://inversegravity.net/about/">about</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <p class="post-meta"><time datetime="2019-05-21T00:00:00+00:00" itemprop="datePublished">May 21, 2019</time></p> <h1 class="post-title" itemprop="name headline">Cryptography - Hash Functions & Digital Signatures</h1> </header> <div class="post-content" itemprop="articleBody"> <p><a href="/2019/crypto-history-basics/" target="_blank">Cryptography - History and Basics</a></p> <p><a href="/2019/crypto-symmetric/" target="_blank">Cryptography - Symmetric Key Algorithms</a></p> <p><a href="/2019/public-key/" target="_blank">Cryptography - Asymmetric Key Algorithms</a></p> <p><a href="/2019/crypto-hash-digital-signature/" target="_blank">Cryptography - Hash Functions &amp; Digital Signatures</a></p> <p><a href="/2019/applied-cryptography/" target="_blank">Cryptography - Applications</a></p> <h3 id="hash-functions---definition">Hash Functions - Definition</h3> <p>Hash functions take a potentially long message as the input and generate a unique output value from the content. The output of a hash function is commonly referred to as the <em>message digest</em>.</p> <p>Hashing is a one-way function and with a properly designed algorithm, there is no way to reverse the hashing process to reveal the original input.</p> <p>Compare this to encryption (two-way function) which allows encryption and decryption with the correct key or key-pair.</p> <p>Another use case of hash functions is in data structures like <a href="https://en.wikipedia.org/wiki/Hash_table" target="_blank">hash tables</a> or <a href="https://en.wikipedia.org/wiki/Bloom_filter" target="_blank">bloom filters</a>. The goal here is not security but rapid data lookup.</p> <p>In my posting about <a href="/2019/gdpr-passwords-hashing-you/" target="_blank">password hashing</a>, we had the requirement that the same input provides different outputs (non-deterministic). This is achieved by using a random salt and it prevents attacks against low-entropy secrets like passwords.</p> <p>Hash functions in the context of digital signatures are supposed to produce the same output for the same input (deterministic). This enables the recipient of a message to recompute the <em>message digest</em> with the same hash function and compare it to the transmitted digest to verify that the message wasn’t modified in transit.</p> <p>If the message has even a minor difference in spacing, punctuation, or content, the message digest will be completely different.</p> <p>It is not possible to derive the degree of difference between two messages by comparing the digest. The slightest difference in the input will produce a totally different digest value.</p> <p><img src="/assets/images/one-way.jpg" alt="a picture showing a city" style="left; padding: 10px 10px 10px 10px;" /></p> <p>There are five requirements for a cryptographic hash function:</p> <ul> <li> <p>The input can be of any length.</p> </li> <li> <p>The output has a fixed length.</p> </li> <li> <p>The hash function is relatively easy to compute for any input.</p> </li> <li> <p>The hash function is one-way (this means it is extremely hard if not impossible to determine the input from the output).</p> </li> <li> <p>The hash function is collision free (there can’t be two different messages producing the same hash value).</p> </li> </ul> <h3 id="sha---secure-hash-algorithm">SHA - Secure Hash Algorithm</h3> <p>The secure hash algorithm SHA and its successors, SHA-1, SHA-2, SHA-3, are government standard hash functions promoted by the National Institute of Standards and Technology (NIST).</p> <p><strong>SHA-1</strong> takes an input of virtually any length and produces a 160-bit message. It processes a message in 512-bit blocks. If a message length isn’t a multiple of 512-bit, the SHA algorithm pads the message with data until the length reaches the next highest multiple of 512-bit.</p> <p>SHA-1 is no longer considered secure against well-funded adversaries. All major web browser manufactures sopped accepting SHA-1 SSL certificates in 2017. Google even <a href="https://phys.org/news/2017-02-cwi-google-collision-industry-standard.html" target="_blank">demonstrated</a> a collision in SHA-1.</p> <p><strong>SHA-2</strong> was published in 2001 as a reaction to the weaknesses in SHA-1. It includes significant changes from its predecessor and has four major variants:</p> <ul> <li> <p>SHA-256 produces a 256-bit message digest using a 512-bit block size.</p> </li> <li> <p>SHA-224 uses a truncated version of the SHA-256 hash and produces a 224-bit digest using a 512-bit block size.</p> </li> <li> <p>SHA-512 produces a 512-bit message digest using a 1,024-bit block size.</p> </li> <li> <p>SHA-384 uses a truncated version of the SHA-512 hash and produces a 384-bit digest using a 1,024-bit block size.</p> </li> </ul> <p>The cryptographic community generally considers SHA-2 algorithms as secure, but it theoretically suffers from the same weakness as the SHA-1 algorithm.</p> <p><strong>SHA-3</strong> was published in 2015, while part of the same series of standards, SHA-3 is internally different from the MD5 like structure of SHA-1 and SHA-2. SHA-3 is a subset of the broader cryptographic primitive family Keccak. It was developed as a drop-in replacement of SHA-2, offering the same variants (SHA3-256/SHA3-224/SHA3-512/SHA3-384) and hash lengths but using a more secure algorithm.</p> <h3 id="md2---message-digest">MD2 - Message Digest</h3> <p>The MD2 Message-Digest Algorithm was developed by <a href="https://en.wikipedia.org/wiki/Ron_Rivest" target="_blank">Ronald Rivest</a> (yes, the one from Rivest, Shamir, and Adleman aka RSA Security) in 1989 to provide a secure hash function for 8-bit processors.</p> <p><strong>MD2</strong> pads the message to a length of a multiple of 16-bit and computes a 16-byte(!) checksum which is appended to the end of the input message. Then a 128-bit message digest is generated by using the original message along with the appended checksum.</p> <p>Cryptanalytic attacks against the MD2 algorithm exist and it was even proven that MD2 is not a one-way function. Therefore, it should no longer be used.</p> <p><strong>MD4</strong> is an enhancement of MD2, was released in 1990 and supports 32-bit processors. It increases the security level with an enhanced algorithm.</p> <p>MD4 pads the message to a length of 64-bit smaller than a multiple of 512-bits. The MD4 algorithm then processes 512-bit blocks of the message in thee rounds of computation to produce a 128-bit message digest.</p> <p>An 8-bit message would be padded with 440 additional bits of data to make it 448-bits, which is 64-bit smaller than a 512-bit message.</p> <p>Several flaws have been found in the MD4 algorithm and therefore it is no longer considered secure. Usage should be avoided if possible.</p> <p><strong>MD5</strong> was released in 1991 as the next version of the message digest algorithm. It also processes 512-bit blocks of the message but uses four rounds of computation to produce the same 128-bit message digest length as in MD2 and MD4.</p> <p>MD5 has the same padding requirements as MD4, the message length must be 64-bit less than a multiple of 512-bit. MD5 introduced additional security features that reduced the speed of message digest production.</p> <p>Recent cryptanalytic attacks demonstrated that MD5 is subject to collisions. In 2005 it was demonstrated that two digital certificates from different public keys have the same MD5 hash.</p> <p>All algorithms in the MD family are no longer accepted as suitable hashing functions. However, they may still be found in use today.</p> <p><img src="/assets/images/digisign.jpg" alt="a picture showing a city" style="left; padding: 10px 10px 10px 10px;" /></p> <h3 id="digital-signatures">Digital Signatures</h3> <p>With secure hash functions, we can implement a digital signature system. A digital signature infrastructure has two goals:</p> <ul> <li> <p>Digitally signed messages assure the recipient that the message came from the claimed sender. This provides nonrepudiation.</p> </li> <li> <p>Digitally signed messages provide the recipient with the assurance that the message was not altered while in transit. This provides protection against malicious (man in the middle) or unintentional (communication interference) modification.</p> </li> </ul> <p><strong>Digital signatures rely on the combination of two concepts, <a href="/2019/public-key/">public-key cryptography</a>, and hash functions.</strong></p> <p>Alice is sending a digitally signed but <strong>not encrypted</strong> message to Bob:</p> <p><strong>1:</strong> Alice generates a message digest of the original plaintext message using a secure hash function like SHA3-512.</p> <p><strong>2:</strong> Alice then encrypts the message digest using her private key. The output is the digital signature.</p> <p><strong>3:</strong> Alice appends the digital signature to the plaintext message.</p> <p><strong>4:</strong> Alice then sends the appended message to Bob</p> <p><strong>5:</strong> Bob removes the digital signature from the appended message and decrypts it with the public key of Alice.</p> <p><strong>6:</strong> Bob calculates the hash of the plaintext message with SHA3-512.</p> <p><strong>7:</strong> Bob then compares the decrypted message digest he received from Alice with the message digest Bob computed. If the two digests match, he can be assured that the message he received was sent by Alice.</p> <p>The digital signature process does not provide any privacy by itself. It only ensures that the cryptographic goals of authentication, integrity, and nonrepudiation are met. If Alice wants to ensure the privacy of her message to Bob, she could encrypt the appended message generated in step <strong>3</strong> with the public key of Bob. Bob then would need to first decrypt the encrypted message with his private key before continuing with step <strong>5</strong>.</p> <p>Digital signatures are used not only for messages but software vendors are often using digital signature technology to authenticate code distribution over insecure networks like the internet. <strong>Checksums</strong> do not require any encryption key, they are simple digests of fingerprints to represent some kind of data.</p> <h3 id="hmac---hashed-message-authentication">HMAC - Hashed Message Authentication</h3> <p>The hashed message authentication code (HMAC) algorithm implements a partial digital signature and guarantees the integrity of a message but it does not provide nonrepudiation.</p> <p><strong>HMAC relies on the combination of two concepts, <a href="/2019/crypto-symmetric/" target="_blank">private-key cryptography</a> and hash functions.</strong></p> <p>HMAC can be combined with any secure hash function such as SHA3. The resulting message authentication code (MAC) is called HMAC-SHA3. HMAC combines a secret key with a hash function and represents a halfway point between unencrypted use of a message digest algorithm and computationally expensive digital signature algorithms based on public-key cryptography.</p> <p>HMAC does not encrypt the message. Instead, the message (encrypted or not) must be sent alongside the HMAC hash. Parties with the secret key will hash the message again themselves, and the received and computed hashes will match if it is authentic.</p> <h3 id="dss---digital-signature-standard">DSS - Digital Signature Standard</h3> <p>This standard specifies that all federally approved digital signature algorithms must use the SHA-3 hashing function. DSS also specifies the encryption algorithms that can be used to support digital signature infrastructure. Currently approved in version <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf" target="_blank">186-4</a> are:</p> <ul> <li> <p>DSA - Digital Signature Algorithm</p> </li> <li> <p>RSA - Rivest-Shamir-Adleman Algorithm</p> </li> <li> <p>ECDSA - Elliptic Curve DSA</p> </li> </ul> <h3 id="key-confusion">Key Confusion</h3> <p>Public-Key Cryptography and Digital Signatures can be confusing. Encryption, Decryption, Digtital Signatures, and Signature verification all use the same algorithms with different key inputs. Here are a few simple rules:</p> <ul> <li> <p>You encrypt a message with the recipients public key.</p> </li> <li> <p>You decrypt a message with your own private key.</p> </li> <li> <p>You digitally sign a message with your own private key.</p> </li> <li> <p>You verify the signature of a message with the senders public key.</p> </li> </ul> </div> <div id="291704505"> <script type="text/javascript"> try { window._mNHandle.queue.push(function (){ window._mNDetails.loadTag("291704505", "320x50", "291704505"); }); } catch (error) {} </script> </div> <span><div style="text-align:center">[ <a href="/tag/security/"><code class="highlighter-rouge"><nobr>security</nobr></code></a> <a href="/tag/technology/"><code class="highlighter-rouge"><nobr>technology</nobr></code></a> <a href="/tag/cryptography/"><code class="highlighter-rouge"><nobr>cryptography</nobr></code></a> ]</div></span> <aside class="share"> <div style="text-align:center"><p>If you liked this article, please share it on <a href="http://twitter.com/share?text=Cryptography - Hash Functions & Digital Signatures. Hash Functions & Digital Signatures&amp;url=https://inversegravity.net/2019/crypto-hash-digital-signature/&amp;via=inversegravityN" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">Twitter</a> or <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://inversegravity.net/2019/crypto-hash-digital-signature/" onclick="window.open(this.href, 'linkedin-share', 'width=550,height=235');return false;">LinkedIn</a></p></div> </aside> </article> <footer class="site-footer"> <div class="container"> <small class="block">&copy; 2022 Maximilian Weber &middot; &lt;/&gt; Powered by <a href="https://jekyllrb.com/">Jekyll</a> </small> </div> </footer> </main> <script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-138082100-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> <style> #cookie-notice {padding: 7px 15px; display: none; text-align: center; position: fixed; bottom: 0; width: 100%; background: #fff; color: rgba(0,0,0,0.8);} #cookie-notice a {cursor: pointer; margin-left: 10px;} @media (max-width: 767px) { #cookie-notice span {display: block; padding-top: 3px; margin-bottom: 13px;} #cookie-notice a {position: relative; bottom: 4px;} } </style> <div id="cookie-notice"><span> By using and navigating this website you agree that we use GitHub Pages, Google Analytics, and Cloudflare.</span><a id="cookie-notice-accept" class="btn btn-primary btn-sm"><br>OK</a></div> <script> function createCookie(name,value,days) { var expires = ""; if (days) { var date = new Date(); date.setTime(date.getTime() + (days*24*60*60*1000)); expires = "; expires=" + date.toUTCString(); } document.cookie = name + "=" + value + expires + "; path=/"; } function readCookie(name) { var nameEQ = name + "="; var ca = document.cookie.split(';'); for(var i=0;i < ca.length;i++) { var c = ca[i]; while (c.charAt(0)==' ') c = c.substring(1,c.length); if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length); } return null; } function eraseCookie(name) { createCookie(name,"",-1); } if(readCookie('cookie-notice-dismissed')=='true') { } else { $('#cookie-notice').show(); } $('#cookie-notice-accept').click(function() { createCookie('cookie-notice-dismissed','true',31); $('#cookie-notice').hide(); location.reload(); }); </script> </body> </html>
